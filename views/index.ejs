<!DOCTYPE html>
<html lang="en">
  <head>
    <% include ./partials/head %>
  </head>
  <body>

    <div class="container">
          
      <h1>Stock Market</h1>
      <div id="chart">
        <!--<%- JSON.stringify(daily) %>-->   
      </div>
      <form method="post" action="/addsymbol">
        <input type="text" name="symbol">
      </form>
      <div id="stocks-info">
      </div>

    </div><!-- /.container -->


    <script src="/socket.io/socket.io.js"></script>
    <script>
    
    var socket = io();
    socket.on('news_by_server', function(data){
    
    var obj =  data.newData;
    $("#stocks-info").empty();
    for(var i=0;i<obj.length;i++){
      var $panel = $("<div>", {id: obj[i].symbol, "class": "panel panel-info"});
      var color = (obj[i].changeInPercent > 0)? "green" : "red" ;      
      $("#stocks-info").append($panel);
      $($panel).append(
      $('<div>')
      .addClass("panel-heading")
      .text(obj[i].symbol+" - "+obj[i].name)      
      ).append(
      $('<div>')
      .addClass("panel-body")
      .html("<b>"+obj[i].open+"</b><br><p> Change: <span class="+color+">"+obj[i].change.toFixed(2) 
      +"</span>  (<span class="+color+">"+ (obj[i].changeInPercent*100).toFixed(2)+"%)</span></p>")      
      )
      
    }
    })
    </script>
    
  </body>
</html>